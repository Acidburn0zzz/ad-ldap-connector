{
  "name": "passport-windowsauth",
  "version": "0.1.3",
  "description": "Passport strategy for Windows Integrated Authentication (NTLM)",
  "main": "lib/strategy.js",
  "scripts": {
    "test": "mocha"
  },
  "repository": {
    "type": "git",
    "url": "https://github.com/auth0/passport-windowsauth.git"
  },
  "keywords": [
    "passport",
    "windows",
    "auth",
    "ntlm"
  ],
  "author": {
    "name": "Auth0"
  },
  "license": "MIT",
  "dependencies": {
    "passport": "~0.1.15",
    "ldapjs": "~0.6.2"
  },
  "devDependencies": {
    "chai": "~1.5.0",
    "mocha": "~1.8.2"
  },
  "readme": "Windows Authentication strategy for Passport.js.\r\n\r\n## Install\r\n\r\n    npm install passport-windowsauth\r\n\r\n## Introduction\r\n\r\nThis module authenticate user with a LDAP directory. It works in two modes **Integrated Authentication** (often refer as NTLM) or **Form Authentication**.\r\n\r\n## Usage with Integrated Authentication\r\n\r\nIn this mode, this strategy reads an special server variable from IIS (more info about this [here](https://github.com/tjanczuk/iisnode/issues/87)) and then generate a profile. You can **optionally** pass some LDAP credentials to fetch the profile from Active Directory. \r\n\r\nThis only works in **WINDOWS** and it only works when running inside of **IIS** whit [IISNode](https://github.com/tjanczuk/iisnode).\r\n\r\n**In your IIS application authentication settings, disable Anonymous and enable Windows Authentication.**\r\n\r\nIf you want to use it with LDAP:\r\n\r\n~~~javascript\r\nvar passport = require('passport');\r\nvar WindowsStrategy = require('passport-windowsauth');\r\n\r\npassport.use(new WindowsStrategy({ \r\n  ldap: {\r\n    url:             'ldap://wellscordoba.wellscordobabank.com/DC=wellscordobabank,DC=com',\r\n    base:            'DC=wellscordobabank,DC=com',\r\n    bindDN:          'someAccount',\r\n    bindCredentials: 'andItsPass'\r\n  }\r\n}, function(profile, done){\r\n  User.findOrCreate({ waId: profile.id }, function (err, user) {\r\n    done(err, user);\r\n  });\r\n}));\r\n~~~\r\n\r\nIf you want to use without LDAP:\r\n\r\n~~~javascript\r\nvar passport = require('passport');\r\nvar WindowsStrategy = require('passport-windowsauth');\r\n\r\npassport.use(function(profile, done){\r\n  User.findOrCreate({ waId: profile.id }, function (err, user) {\r\n    done(err, user);\r\n  });\r\n}));\r\n~~~\r\n\r\nNOTE: in this case profile only has ```displayName``` and ```id```, and the two variables with the same value.\r\n\r\nThen use the strategy in a route as follows:\r\n\r\n~~~javascript\r\napp.get('/express-passport', \r\n  passport.authenticate('WindowsAuthentication'),\r\n  function (req, res){\r\n    res.json(req.user);\r\n  });\r\n~~~\r\n\r\n## Non-integrated authentication\r\n\r\nYou can use this module to authenticate users against a LDAP server without integrated authentication.\r\nYou will prompt the user for his username and password in a form like this:\r\n\r\n~~~html\r\n<form action=\"/login\" method=\"post\">\r\n    <div>\r\n        <label>Username:</label>\r\n        <input type=\"text\" name=\"username\"/>\r\n    </div>\r\n    <div>\r\n        <label>Password:</label>\r\n        <input type=\"password\" name=\"password\"/>\r\n    </div>\r\n    <div>\r\n        <input type=\"submit\" value=\"Log In\"/>\r\n    </div>\r\n</form>\r\n~~~\r\n\r\nand then have a route like this:\r\n\r\n~~~javascript\r\napp.post('/login',\r\n  passport.authenticate('WindowsAuthentication', { \r\n                                  successRedirect: '/',\r\n                                  failureRedirect: '/login',\r\n                                  failureFlash:    true })\r\n);\r\n~~~\r\n\r\nThe same configuration as explained above is required with the ```integrated``` option in false:\r\n\r\n~~~javascript\r\nvar passport = require('passport');\r\nvar WindowsStrategy = require('passport-windowsauth');\r\n\r\npassport.use(new WindowsStrategy({ \r\n  ldap: {\r\n    url:             'ldap://wellscordoba.wellscordobabank.com/DC=wellscordobabank,DC=com',\r\n    base:            'DC=wellscordobabank,DC=com',\r\n    bindDN:          'someAccount',\r\n    bindCredentials: 'andItsPass',\r\n    integrated:      false\r\n  }\r\n}, function(profile, done){\r\n  User.findOrCreate({ waId: profile.id }, function (err, user) {\r\n    done(err, user);\r\n  });\r\n}));\r\n~~~\r\n\r\n## Example profile from LDAP\r\n\r\nWhen you use the LDAP integration the profile follows the [Passport.js user profile convention](http://passportjs.org/guide/profile/) and you have also a _json property with all the profile.\r\n\r\nExample:\r\n\r\n~~~json\r\n{\r\n  \"id\": \"fe59e96-4d82-431e-816a-5a688e4ab547\",\r\n  \"displayName\": \"Jose Romaniello\",\r\n  \"name\": {\r\n    \"familyName\": \"Romaniello\",\r\n    \"givenName\": \"Jose\"\r\n  },\r\n  \"emails\": [\r\n    {\r\n      \"value\": \"jromaniello@wellscordoba.com\"\r\n    }\r\n  ],\r\n  \"_json\": {\r\n    \"dn\": \"CN=Jose Romaniello,CN=Users,DC=wellscordobabank,DC=com\",\r\n    \"controls\": [],\r\n    \"objectClass\": [\r\n      \"top\",\r\n      \"person\",\r\n      \"organizationalPerson\",\r\n      \"user\"\r\n    ],\r\n    \"cn\": \"Jose Romaniello\",\r\n    \"sn\": \"Romaniello\",\r\n    \"title\": \"cantante desafinado - programador experto\",\r\n    \"physicalDeliveryOfficeName\": \"Chief Architect\",\r\n    \"telephoneNumber\": \"+543519998822\",\r\n    \"givenName\": \"Jose\",\r\n    \"distinguishedName\": \"CN=Jose Romaniello,CN=Users,DC=wellscordobabank,DC=com\",\r\n    \"instanceType\": \"4\",\r\n    \"whenCreated\": \"20130220172116.0Z\",\r\n    \"whenChanged\": \"20130220183149.0Z\",\r\n    \"displayName\": \"Jose Romaniello\",\r\n    \"uSNCreated\": \"12717\",\r\n    \"uSNChanged\": \"12792\",\r\n    \"company\": \"Wells Cordoba Bank\",\r\n    \"name\": \"Jose Romaniello\",\r\n    \"objectGUID\": \"fe59e96-4d82-431e-816a-5a688e4ab547\",\r\n    \"userAccountControl\": \"66048\",\r\n    \"badPwdCount\": \"0\",\r\n    \"codePage\": \"0\",\r\n    \"countryCode\": \"0\",\r\n    \"badPasswordTime\": \"0\",\r\n    \"lastLogoff\": \"0\",\r\n    \"lastLogon\": \"0\",\r\n    \"pwdLastSet\": \"130058544776047558\",\r\n    \"primaryGroupID\": \"513\",\r\n    \"objectSid\": \"\\u0001\\u0005\\u0000\\u0000\\u0000\\u0000\\u0000\\u0005\\u0015\\u0000\\u0000\\u0000��=��\\u001d��uQ��O\\u0004\\u0000\\u0000\",\r\n    \"accountExpires\": \"9223372036854775807\",\r\n    \"logonCount\": \"0\",\r\n    \"sAMAccountName\": \"jromaniello\",\r\n    \"sAMAccountType\": \"805306368\",\r\n    \"userPrincipalName\": \"jromaniello@wellscordobabank.com\",\r\n    \"objectCategory\": \"CN=Person,CN=Schema,CN=Configuration,DC=wellscordobabank,DC=com\",\r\n    \"dSCorePropagationData\": [\r\n      \"20130220172118.0Z\",\r\n      \"16010101000000.0Z\"\r\n    ],\r\n    \"lastLogonTimestamp\": \"130058572786126285\",\r\n    \"mail\": \"jromaniello@wellscordobabank.com\"\r\n  }\r\n}\r\n~~~ \r\n\r\n## License\r\n\r\nMIT 2013!",
  "_id": "passport-windowsauth@0.1.2",
  "_from": "passport-windowsauth@~0.1.1"
}
