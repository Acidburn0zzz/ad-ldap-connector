{
  "name": "passport-windowsauth",
  "version": "0.1.5",
  "description": "Passport strategy for Windows Integrated Authentication (NTLM)",
  "main": "lib/strategy.js",
  "scripts": {
    "test": "mocha"
  },
  "repository": {
    "type": "git",
    "url": "https://github.com/auth0/passport-windowsauth.git"
  },
  "keywords": [
    "passport",
    "windows",
    "auth",
    "ntlm"
  ],
  "author": {
    "name": "Auth0"
  },
  "license": "MIT",
  "dependencies": {
    "passport": "~0.1.15",
    "ldapjs": "https://github.com/auth0/node-ldapjs/tarball/master"
  },
  "devDependencies": {
    "chai": "~1.5.0",
    "mocha": "~1.8.2"
  },
  "readme": "Windows Authentication strategy for Passport.js.\n\n## Install\n\n    npm install passport-windowsauth\n\n## Introduction\n\nThis module authenticate user with a LDAP directory. It works in two modes **Integrated Authentication** (often refer as NTLM) or **Form Authentication**.\n\n## Usage with Integrated Authentication\n\nIn this mode, this strategy reads an special server variable from IIS (more info about this [here](https://github.com/tjanczuk/iisnode/issues/87)) and then generate a profile. You can **optionally** pass some LDAP credentials to fetch the profile from Active Directory. \n\nThis only works in **WINDOWS** and it only works when running inside of **IIS** whit [IISNode](https://github.com/tjanczuk/iisnode).\n\n**In your IIS application authentication settings, disable Anonymous and enable Windows Authentication.**\n\nIf you want to use it with LDAP:\n\n~~~javascript\nvar passport = require('passport');\nvar WindowsStrategy = require('passport-windowsauth');\n\npassport.use(new WindowsStrategy({ \n  ldap: {\n    url:             'ldap://wellscordoba.wellscordobabank.com/DC=wellscordobabank,DC=com',\n    base:            'DC=wellscordobabank,DC=com',\n    bindDN:          'someAccount',\n    bindCredentials: 'andItsPass'\n  }\n}, function(profile, done){\n  User.findOrCreate({ waId: profile.id }, function (err, user) {\n    done(err, user);\n  });\n}));\n~~~\n\nIf you want to use without LDAP:\n\n~~~javascript\nvar passport = require('passport');\nvar WindowsStrategy = require('passport-windowsauth');\n\npassport.use(function(profile, done){\n  User.findOrCreate({ waId: profile.id }, function (err, user) {\n    done(err, user);\n  });\n}));\n~~~\n\nNOTE: in this case profile only has ```displayName``` and ```id```, and the two variables with the same value.\n\nThen use the strategy in a route as follows:\n\n~~~javascript\napp.get('/express-passport', \n  passport.authenticate('WindowsAuthentication'),\n  function (req, res){\n    res.json(req.user);\n  });\n~~~\n\n## Non-integrated authentication\n\nYou can use this module to authenticate users against a LDAP server without integrated authentication.\nYou will prompt the user for his username and password in a form like this:\n\n~~~html\n<form action=\"/login\" method=\"post\">\n    <div>\n        <label>Username:</label>\n        <input type=\"text\" name=\"username\"/>\n    </div>\n    <div>\n        <label>Password:</label>\n        <input type=\"password\" name=\"password\"/>\n    </div>\n    <div>\n        <input type=\"submit\" value=\"Log In\"/>\n    </div>\n</form>\n~~~\n\nand then have a route like this:\n\n~~~javascript\napp.post('/login',\n  passport.authenticate('WindowsAuthentication', { \n                                  successRedirect: '/',\n                                  failureRedirect: '/login',\n                                  failureFlash:    true })\n);\n~~~\n\nThe same configuration as explained above is required with the ```integrated``` option in false:\n\n~~~javascript\nvar passport = require('passport');\nvar WindowsStrategy = require('passport-windowsauth');\n\npassport.use(new WindowsStrategy({ \n  ldap: {\n    url:             'ldap://wellscordoba.wellscordobabank.com/DC=wellscordobabank,DC=com',\n    base:            'DC=wellscordobabank,DC=com',\n    bindDN:          'someAccount',\n    bindCredentials: 'andItsPass',\n    integrated:      false\n  }\n}, function(profile, done){\n  User.findOrCreate({ waId: profile.id }, function (err, user) {\n    done(err, user);\n  });\n}));\n~~~\n\n## Example profile from LDAP\n\nWhen you use the LDAP integration the profile follows the [Passport.js user profile convention](http://passportjs.org/guide/profile/) and you have also a _json property with all the profile.\n\nExample:\n\n~~~json\n{\n  \"id\": \"fe59e96-4d82-431e-816a-5a688e4ab547\",\n  \"displayName\": \"Jose Romaniello\",\n  \"name\": {\n    \"familyName\": \"Romaniello\",\n    \"givenName\": \"Jose\"\n  },\n  \"emails\": [\n    {\n      \"value\": \"jromaniello@wellscordoba.com\"\n    }\n  ],\n  \"_json\": {\n    \"dn\": \"CN=Jose Romaniello,CN=Users,DC=wellscordobabank,DC=com\",\n    \"controls\": [],\n    \"objectClass\": [\n      \"top\",\n      \"person\",\n      \"organizationalPerson\",\n      \"user\"\n    ],\n    \"cn\": \"Jose Romaniello\",\n    \"sn\": \"Romaniello\",\n    \"title\": \"cantante desafinado - programador experto\",\n    \"physicalDeliveryOfficeName\": \"Chief Architect\",\n    \"telephoneNumber\": \"+543519998822\",\n    \"givenName\": \"Jose\",\n    \"distinguishedName\": \"CN=Jose Romaniello,CN=Users,DC=wellscordobabank,DC=com\",\n    \"instanceType\": \"4\",\n    \"whenCreated\": \"20130220172116.0Z\",\n    \"whenChanged\": \"20130220183149.0Z\",\n    \"displayName\": \"Jose Romaniello\",\n    \"uSNCreated\": \"12717\",\n    \"uSNChanged\": \"12792\",\n    \"company\": \"Wells Cordoba Bank\",\n    \"name\": \"Jose Romaniello\",\n    \"objectGUID\": \"fe59e96-4d82-431e-816a-5a688e4ab547\",\n    \"userAccountControl\": \"66048\",\n    \"badPwdCount\": \"0\",\n    \"codePage\": \"0\",\n    \"countryCode\": \"0\",\n    \"badPasswordTime\": \"0\",\n    \"lastLogoff\": \"0\",\n    \"lastLogon\": \"0\",\n    \"pwdLastSet\": \"130058544776047558\",\n    \"primaryGroupID\": \"513\",\n    \"objectSid\": \"\\u0001\\u0005\\u0000\\u0000\\u0000\\u0000\\u0000\\u0005\\u0015\\u0000\\u0000\\u0000��=��\\u001d��uQ��O\\u0004\\u0000\\u0000\",\n    \"accountExpires\": \"9223372036854775807\",\n    \"logonCount\": \"0\",\n    \"sAMAccountName\": \"jromaniello\",\n    \"sAMAccountType\": \"805306368\",\n    \"userPrincipalName\": \"jromaniello@wellscordobabank.com\",\n    \"objectCategory\": \"CN=Person,CN=Schema,CN=Configuration,DC=wellscordobabank,DC=com\",\n    \"dSCorePropagationData\": [\n      \"20130220172118.0Z\",\n      \"16010101000000.0Z\"\n    ],\n    \"lastLogonTimestamp\": \"130058572786126285\",\n    \"mail\": \"jromaniello@wellscordobabank.com\"\n  }\n}\n~~~ \n\n## License\n\nMIT 2013!",
  "_id": "passport-windowsauth@0.1.5",
  "dist": {
    "shasum": "eed4056136d29a9310b8a05ef3f7ab951f45c936"
  },
  "_from": "passport-windowsauth"
}
